library(dplyr)
library(tigris)

#options(tigris_use_cache = TRUE)

# read in data
svi_data <- read.csv("./data/svi_tx_2020.csv") 
shp_file <- tigris::tracts(state = "48", year = "2020", cb = T)

svi_vars <- c("rpl_theme1", "rpl_theme2", "rpl_theme3", "rpl_theme4", "rpl_themes")
geo_data <- shp_file %>%
  left_join(svi_data %>% mutate(FIPS = as.character(FIPS)), by = c("GEOID" = "FIPS")) %>%
  rename_all(tolower) %>%
  filter_at(svi_vars, all_vars(. >= 0)) %>%
  mutate(across(svi_vars, ~round(.x, digits = 2))) %>%
  filter(countyfp == 201) #filter to Harris County for now

# drop-down menu options
vars <- c(
  "Socioeconomic status" = "rpl_theme1",
  "Household characteristics" = "rpl_theme2",
  "Race and ethnic minority status" = "rpl_theme3",
  "Housing type/Transportation" = "rpl_theme4",
  "Overall SVI" = "rpl_themes"
)

# color palettes for each SVI theme
pal_cols <- list(
  "rpl_themes" = "YlGnBu", 
  "rpl_theme1" = "Blues",
  "rpl_theme2" = "Greens",
  "rpl_theme3" = "Reds",
  "rpl_theme4" = "Purples",
  TRUE ~ "YlOrRd"
)
